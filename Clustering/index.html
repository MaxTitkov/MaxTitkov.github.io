
<!DOCTYPE html>
<html class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="A short description of my project">
      
      
      
        <meta name="author" content="Max Titkov">
      
      
        <link rel="shortcut icon" href="../assets/images/favicon.ico">
      
      <meta name="generator" content="mkdocs+mkdocs-material#1.0.3">
    
    
      
        <title>Обучение без учителя - My_Project</title>
      
    
    
      <script src="../assets/javascripts/modernizr-facb31f4a3.js"></script>
    
    
      
        
        
        
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Ubuntu:300,400,400i,700|Ubuntu+Mono">
        <style>body,input{font-family:"Ubuntu","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Ubuntu Mono","Courier New",Courier,monospace}</style>
      
      <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    
    
      <link rel="stylesheet" href="../assets/stylesheets/application-bc099a55ca.css">
      
        <link rel="stylesheet" href="../assets/stylesheets/application-02ce7adcc2.palette.css">
      
      
    
    
  </head>
  
  
  
  
    <body data-md-color-primary="red" data-md-color-accent="blue">
  
    <svg class="md-svg">
      <defs>
        
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="drawer">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="search">
    <label class="md-overlay" data-md-component="overlay" for="drawer"></label>
    
      <header class="md-header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href=".." title="My_Project" class=" md-icon md-icon--home  md-header-nav__button">
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <span class="md-flex__ellipsis md-header-nav__title">
          
            
              
            
            Обучение без учителя
          
        </span>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="search"></label>
          
<div class="md-search" data-md-component="search">
  <div class="md-search__overlay"></div>
  <div class="md-search__inner">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" accesskey="s" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false">
      <label class="md-icon md-search__icon" for="search"></label>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result"></div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            
          </div>
      </div>
    </div>
  </nav>
</header>
    
    <div class="md-container">
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary">
  <label class="md-nav__title md-nav__title--site" for="drawer">
    <i class=" md-icon md-icon--home  md-nav__button">
      
    </i>
    My_Project
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  <li class="md-nav__item">
    
      <a href=".." title="Home" class="md-nav__link">
        Home
      </a>
    
  </li>

    
      
      
  <li class="md-nav__item">
    
      <a href="../about/" title="About" class="md-nav__link">
        About
      </a>
    
  </li>

    
      
      
  <li class="md-nav__item">
    
      <a href="../FFN/" title="Простые нейронные сети" class="md-nav__link">
        Простые нейронные сети
      </a>
    
  </li>

    
      
      
  <li class="md-nav__item">
    
      <a href="../CNN/" title="Свёрточные нейронные сети" class="md-nav__link">
        Свёрточные нейронные сети
      </a>
    
  </li>

    
      
      
  <li class="md-nav__item">
    
      <a href="../RNN/" title="Рекуррентные нейронные сети" class="md-nav__link">
        Рекуррентные нейронные сети
      </a>
    
  </li>

    
      
      
  <li class="md-nav__item">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="toc">
    
    
    <a href="./" title="Обучение без учителя" class="md-nav__link md-nav__link--active">
      Обучение без учителя
    </a>
    
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
               
              
                
                  <h1>Обучение без учителя</h1>
                
                <p>Все перечисленные мною выше методы относят к разделу машинного обучению с учителем. При обучении с учителем вы имеете 1. Объекты с признаками и 2. какие-либо правильные ответы. Например: объекты- пациенты, признаки- баллы по МППЙ тесту, а правильные ответы- диагнозы. Вы загружаете в модель баллы по ММПЙ по каждому больноу и хотите, чтобы модель на них научилась предсказывать диагноз.</p>
<p>Обучение без учителя (Unsupervised learning) не предусматривает какого-либо правильного ответа. Машина сама должна определить, классы объектов. Делает она это на основании похожести объектов по их признакам. Например, алгоритм может автоматически разделить пациентов на несколько групп на основании баллов ММПЙ. Мы можем проанализировать эти группы и понять, имеет ли это разделение для нас какое-либо значение или нет.</p>
<p>На мой взгляд, лучшей иллюстрацией этого метода является работа по <a/ href="http://www.nature.com/nm/journal/v23/n1/full/nm.4246.html">выявлению биотипов депрессии на основании данных МРТ</a>.</p>
<p>Я проиллюстрирую работу алгоритмов обучения без учителя на двух примерах.</p>
<p>В первом примере мы используем набор данных по названием <a>Iris dataset</a>. <img src="http://sebastianraschka.com/images/blog/2014/linear-discriminant-analysis/iris_petal_sepal.png" width="300"> </p>
<p>Это классический набор данных. Он включает в себя набор из 150 экземпляров цветков ирисов. Данные представляют из себя 4 измерения лепестков:</p>
<ol>
<li>Длина наружной доли околоцветника (англ. sepal length);</li>
<li>Ширина наружной доли околоцветника (англ. sepal width);</li>
<li>Длина внутренней доли околоцветника (англ. petal length);</li>
<li>Ширина внутренней доли околоцветника (англ. petal width).</li>
</ol>
<p>Допустим, мы заметили, что цветки разных ирисов отличаются друг от друга. Мы предположили, что в нашей оранжерее есть 2 или 3 вида ирисов. Можно ли на основании измерений цветков классифицировать ирисы?</p>
<ol>
<li>Выдвинем гипотезу, что в настоящем наборе присутствет больше одного вида растений и проверим её.</li>
<li>Если гипотеза верна и в наборе есть более одного вида растений, автоматически разметим эти классы.</li>
</ol>
<p>Загрузим данные</p>
<pre><code class="python">iris = datasets.load_iris()
data = iris.data
</code></pre>

<p>Итак, мы имеем я описал выше. Ниже приведены первые 5 ирисов из набора.</p>
<pre><code class="python">data[:5]
</code></pre>

<pre><code>array([[ 5.1,  3.5,  1.4,  0.2],
       [ 4.9,  3. ,  1.4,  0.2],
       [ 4.7,  3.2,  1.3,  0.2],
       [ 4.6,  3.1,  1.5,  0.2],
       [ 5. ,  3.6,  1.4,  0.2]])
</code></pre>
<p>То есть, для первого цветка:
1. Длина наружной доли околоцветника (англ. sepal length) = 5.1
2. Ширина наружной доли околоцветника (англ. sepal width) = 3.5
3. Длина внутренней доли околоцветника (англ. petal length) = 1.4
4. Ширина внутренней доли околоцветника (англ. petal width) = 0.2</p>
<p>и так далее.</p>
<p>Для проверки гипотезы о том, что в наборе несколько видов ирисов, я использую один из самых распространённых алгоритмов под названием <a href='https://en.wikipedia.org/wiki/T-distributed_stochastic_neighbor_embedding'>TSNE (t-distributed Stochastic Neighbor Embedding)</a>.</p>
<pre><code class="python">tsne=TSNE(n_components=2, init='pca', random_state=0,learning_rate=150)
coord=tsne.fit_transform(data)
</code></pre>

<p>Мы загрузили данные в алгоритм и настроили его.
Образно говоря, алгоритм производит уменьшение размерности наших данных с 4-х измерений до 2-х для того, чтобы эти данные можно было визуализировать на диаграмме.</p>
<p>Построим диаграмму:</p>
<p><img alt="png" src="../images/output_14_1.png" /></p>
<p>Каждая точка представляет отдельный цветок. Чем измерения каждого цветка больше похожи друг на друга, тем ближе друг к другу их представления на диаграмме.</p>
<p>Визуально мы можем точно утверждать, что у нас есть 2 класса. Но, если присмотреться, то в болшая область также слабо делится на 2 части. То есть, возможно, что классов три. Гипотеза подтвердилась: в нашем наборе данных присутствует больше одного класса растений.</p>
<p>Давайте точно определим, сколько у нас классов: 2 или 3 и разметим все цетки.</p>
<p>Для этого применим алгоритм, под названием AffinityPropagation. Это тоже очень распространённый алгоритм, применяемый во многих сферах.</p>
<pre><code class="python">af = AffinityPropagation(preference=-50).fit(data)
cluster_centers_indices = af.cluster_centers_indices_
n_clusters_ = len(cluster_centers_indices)
labels = af.labels_
</code></pre>

<p>Мы загрузили данные в алгоритм и он автоматически выделил классы. Давайте мы возьмём предыдущий график и каждый полученный класс цветка обозначим отдельным цветом:</p>
<p><img alt="png" src="../images/output_19_1.png" /></p>
<p>Мы видим, что классов у нас всё-таки три. Крупные точки - это цветки, характеристики которых являются наиболее типичными для определённого класса.
Из диаграммы также видно, что один класс ирисов имеет более выраженные внешние различия с остальными классами.</p>
<p>Отлично! Наши гипотезы подтвердились!</p>
<p>На самом деле, набор данных ирисов уже разделён на классы. Давайте проверим, насколько наш алгоритм хорошо справился с задачей.</p>
<pre><code class="python">y=iris.target
pd.crosstab(labels, y)
</code></pre>

<div>
<table border="3" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>col_0</th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
    </tr>
    <tr>
      <th>row_0</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>50</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0</td>
      <td>41</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0</td>
      <td>9</td>
      <td>48</td>
    </tr>
  </tbody>
</table>
</div>

<p>Нулевой класс алгоритм поеределил на 100% правильно. В первом классе наш алгоритм ошибся на 9 цветков. Во втором классе - всего на два цветка. Точность алгоритма составила 92%.</p>
<p>Давайте обведём объкеты, которые алгоритм обибочно определил.</p>
<p><img alt="png" src="../images/output_23_1.png" /></p>
<p>Как видите, наш алгоритм по большей части ошибся в тех случаях, когда данные находились на границе двух кластеров.</p>
<p>Теперь давайте посмотрим на цветки каждого вида</p>
<p><img src="https://c.mql5.com/2/3/Figure10_Iris_flower.png" width="700"></p>
<p>Видим, что  Ирис щетинистый (Iris setosa) больше отличается от виргинского (iris virginica) и разноцветного (iris vasilor) ирисов</p>
<p>Я продемонстрировал работу алгоритмов обучения без учителя на простом наборе данных. Вообще, эти алгоритмы можно применять для данных любой размерности с сотнями признаков.</p>
<p>Ну, например:</p>
<pre><code class="python">from sklearn.datasets import load_digits
digits = datasets.load_digits()
X = digits.data
y = digits.target

X.shape
</code></pre>

<pre><code>(1797, 64)
</code></pre>
<p>Мы загрузили набор данных, в котором 1797 объектов и у каждого объекта 64 признака</p>
<p>Давайте посмотрим на один из объектов:</p>
<pre><code class="python">X[0]
</code></pre>

<pre><code>array([  0.,   0.,   5.,  13.,   9.,   1.,   0.,   0.,   0.,   0.,  13.,
        15.,  10.,  15.,   5.,   0.,   0.,   3.,  15.,   2.,   0.,  11.,
         8.,   0.,   0.,   4.,  12.,   0.,   0.,   8.,   8.,   0.,   0.,
         5.,   8.,   0.,   0.,   9.,   8.,   0.,   0.,   4.,  11.,   0.,
         1.,  12.,   7.,   0.,   0.,   2.,  14.,   5.,  10.,  12.,   0.,
         0.,   0.,   0.,   6.,  13.,  10.,   0.,   0.,   0.])
</code></pre>
<p>А теперь давайте визуализируем все объекты по схожести, как в предыдущем примере. То есть, мы уменьшим количество признаков каждого объекта с 64 до двух (то есть, до координат x и y), чтобы из визуализироват. Затем визуализируем.</p>
<p><img alt="png" src="../images/output_37_1.png" /></p>
<p>Отчётливо видим 8 "переферийных" кластеров и 2 "внутренних". То есть, вероятнее всего, у нас 10 классов объектов.</p>
<p>Попробуем разместьить эти классы:</p>
<pre><code class="python">from sklearn.cluster import KMeans
y_pred = KMeans(n_clusters=10, random_state=1, init='k-means++').fit_predict(X)

</code></pre>

<p><img alt="png" src="../images/output_46_1.png" /></p>
<p>Видим, что алгоритм разметил классы по их прибилизительному сходству. Визуально мы можем сказать, что он по большей части "попал" правильно.</p>
<p>На самом деле, нашими данными были картинки с набором наборы рукописных цифр от нуля до 10. Выглядят они вот так:</p>
<figure>
    <img src="http://scikit-learn.org/stable/_images/sphx_glr_plot_lle_digits_001.png"  >
    <figcaption>Набор данных (взято <a/ href="http://scikit-learn.org/stable/auto_examples/manifold/plot_lle_digits.html">тут</a>)</figcaption>
</figure>

<p>Их двумерное представление такое:
<img alt="png" src="../images/output_48_0.png" /></p>
<p>При подготовке главы я опирался на <a/ href='http://scikit-learn.org/stable/auto_examples/manifold/plot_lle_digits.html'>эти примеры </a>.</p>
<p>Это простые примеры применения данных алгоритмов.</p>
              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../RNN/" title="Рекуррентные нейронные сети" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Рекуррентные нейронные сети
              </span>
            </div>
          </a>
        
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; 2017 Maxim Titkov
          </div>
        
        powered by
        <a href="http://www.mkdocs.org" title="MkDocs">MkDocs</a>
        and
        <a href="http://squidfunk.github.io/mkdocs-material/" title="Material for MkDocs">
          Material for MkDocs</a>
      </div>
      
        
  <div class="md-footer-social">
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    
      <a href="https://www.facebook.com/maxim.max.399041" class="md-footer-social__link fa fa-facebook"></a>
    
  </div>

      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/application-7f35cda7dd.js"></script>
      <script>var config={url:{base:".."}},app=new Application(config);app.initialize()</script>
      
    
    
      
    
  </body>
</html>